{"version":3,"file":"review_progress.min.js","sources":["../src/review_progress.js"],"sourcesContent":["/* eslint-disable */\n// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * Polls backend for progress of AI reviews and updates UI accordingly.\n *\n * @module     local_assign_ai/review_progress\n * @copyright  2025 Wilber Narvaez <https://datacurso.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport { get_string as getString } from 'core/str';\n\nconst POLL_MS_DEFAULT = 8000;\nlet intervalid = 0;\n\n// Client-side smoothing state per row. We keep randomized parameters per processing session\n// so that progress does not look identical across rows or sessions.\nconst startTimes = new Map(); // pendingid -> timestamp ms\nconst expectedDurations = new Map(); // pendingid -> ms\nconst startOffsets = new Map(); // pendingid -> int percent (1..8)\nconst curveFactors = new Map(); // pendingid -> float (0.6..1.4)\nconst lastShown = new Map(); // pendingid -> last integer percent shown\n\nfunction setLinkDisabled(link, disabled) {\n    if (!link) {\n        return;\n    }\n    if (disabled) {\n        link.classList.add('disabled');\n        link.setAttribute('aria-disabled', 'true');\n        link.setAttribute('tabindex', '-1');\n    } else {\n        link.classList.remove('disabled');\n        link.removeAttribute('aria-disabled');\n        link.removeAttribute('tabindex');\n    }\n}\n\n/**\n * Check if there are rows that should be polled.\n * @returns {boolean}\n */\nfunction hasActiveRows() {\n    return !!document.querySelector('tr[data-status=\"processing\"], tr[data-status=\"queued\"], tr.js-row-inprogress, tr.js-row-queued');\n}\n\nfunction hasPendingRows() {\n    return !!document.querySelector('tr[data-status=\"pending\"], tr.js-row-pending');\n}\n\n/**\n * Apply a grade value (if present) to the grade cell in the given row.\n *\n * @param {HTMLElement} row\n * @param {number|null|undefined} grade\n */\nfunction applyGradeToRow(row, grade) {\n    if (!row) {\n        return;\n    }\n\n    const gradeCell = row.querySelector('.js-grade-cell');\n    if (!gradeCell) {\n        return;\n    }\n\n    if (typeof grade !== 'undefined' && grade !== null) {\n        const rounded = Math.round(grade);\n        gradeCell.textContent = String(rounded);\n    } else {\n        gradeCell.textContent = '-';\n    }\n}\n\n/**\n * Disable/enable the header buttons depending on current progress state.\n */\nfunction reflectHeaderButtonsState() {\n    const anyActive = hasActiveRows();\n    const anyPending = hasPendingRows();\n    const btnReviewAll = document.querySelector('.js-review-all');\n    const btnApproveAll = document.querySelector('.js-approve-all');\n\n    if (btnReviewAll) {\n        btnReviewAll.disabled = anyActive || btnReviewAll.disabled;\n    }\n    if (btnApproveAll) {\n        const enableApprove = anyPending && !anyActive;\n        if (enableApprove) {\n            btnApproveAll.removeAttribute('disabled');\n        } else {\n            btnApproveAll.setAttribute('disabled', 'disabled');\n        }\n    }\n}\n\n/**\n * Update a single row UI using progress info.\n * @param {HTMLElement} row\n * @param {number} progress\n * @param {string} status\n */\nfunction updateRow(row, progress, status, grade) {\n    const badge = row.querySelector('.js-state-badge');\n    const hint = row.querySelector('.js-state-hint');\n    let indicator = row.querySelector('.js-progress-indicator');\n    const btnReview = row.querySelector('.js-btn-review');\n    const btnDetails = row.querySelector('.js-btn-details');\n    const btnGrade = row.querySelector('.js-btn-grade');\n\n    if (status === 'processing' && progress > 0 && progress < 100) {\n        row.classList.add('js-row-inprogress');\n        if (!indicator) {\n            indicator = document.createElement('div');\n            indicator.className = 'small text-warning js-progress-indicator';\n            indicator.innerHTML = '<span class=\"spinner-border spinner-border-sm me-1\" role=\"status\" aria-hidden=\"true\"></span>';\n            row.querySelector('td:nth-child(7)')?.appendChild(indicator);\n        }\n        getString('processing', 'local_assign_ai').then(txt => {\n            indicator.innerHTML = '<span class=\"spinner-border spinner-border-sm me-1\" role=\"status\" aria-hidden=\"true\"></span>' + txt + ' (' + progress + '%)';\n        }).catch(() => { });\n\n        // Disable row action buttons while in progress.\n        row.querySelectorAll('button').forEach(b => b.setAttribute('disabled', 'disabled'));\n        setLinkDisabled(btnGrade, true);\n    } else {\n        row.classList.remove('js-row-inprogress');\n        if (indicator) {\n            indicator.remove();\n        }\n        // Re-enable row buttons depending on status.\n        if (status === 'initial') {\n            row.querySelectorAll('.js-review-ai').forEach(b => b.removeAttribute('disabled'));\n            setLinkDisabled(btnGrade, false);\n        } else if (status === 'pending') {\n            row.querySelectorAll('.view-details').forEach(b => b.removeAttribute('disabled'));\n            setLinkDisabled(btnGrade, false);\n        } else if (status === 'queued') {\n            // Keep disabled while waiting for processing to start.\n            row.querySelectorAll('button').forEach(b => b.setAttribute('disabled', 'disabled'));\n            setLinkDisabled(btnGrade, true);\n        } else {\n            row.querySelectorAll('button').forEach(b => b.removeAttribute('disabled'));\n            setLinkDisabled(btnGrade, false);\n        }\n    }\n\n    if (badge && hint) {\n        // Update badge class and short text per status, and the longer hint below.\n        if (status === 'initial') {\n            badge.className = 'badge bg-secondary js-state-badge';\n            getString('aistatus_initial_short', 'local_assign_ai').then(t => { badge.textContent = t; }).catch(() => { });\n            getString('aistatus_initial_help', 'local_assign_ai').then(t => { hint.textContent = t; }).catch(() => { });\n        } else if (status === 'queued') {\n            badge.className = 'badge bg-warning js-state-badge';\n            getString('aistatus_queued_short', 'local_assign_ai').then(t => { badge.textContent = t; }).catch(() => { });\n            getString('aistatus_queued_help', 'local_assign_ai').then(t => { hint.textContent = t; }).catch(() => { });\n        } else if (status === 'processing') {\n            badge.className = 'badge bg-warning js-state-badge';\n            getString('processing', 'local_assign_ai').then(t => { badge.textContent = t; }).catch(() => { });\n            getString('aistatus_processing_help', 'local_assign_ai').then(t => { hint.textContent = t; }).catch(() => { });\n        } else if (status === 'pending') {\n            badge.className = 'badge bg-info js-state-badge';\n            getString('aistatus_pending_short', 'local_assign_ai').then(t => { badge.textContent = t; }).catch(() => { });\n            getString('aistatus_pending_help', 'local_assign_ai').then(t => { hint.textContent = t; }).catch(() => { });\n        }\n    }\n\n    // Toggle visibility of action buttons based on status.\n    if (btnReview && btnDetails) {\n        if (status === 'pending' || progress >= 100) {\n            btnReview.classList.add('d-none');\n            btnDetails.classList.remove('d-none');\n        } else if (status === 'initial' || status === 'queued' || status === 'processing') {\n            btnDetails.classList.add('d-none');\n            btnReview.classList.remove('d-none');\n        }\n    }\n\n    // When a row finishes processing and becomes pending, set its grade (if provided) without reloading the page.\n    if (status === 'pending') {\n        applyGradeToRow(row, grade);\n    }\n}\n\n/**\n * Find pending ids in the table that need updates.\n * @returns {number[]}\n */\nfunction collectPendingIds() {\n    const rows = document.querySelectorAll('tr[data-pendingid]');\n    const ids = [];\n    rows.forEach(row => {\n        const pid = parseInt(row.getAttribute('data-pendingid'), 10);\n        if (!pid) {\n            return;\n        }\n        const status = (row.getAttribute('data-status') || '').toLowerCase();\n        const isProcessing = status === 'processing';\n        const isQueued = status === 'queued';\n        const fallbackProcessing = !status && row.classList.contains('js-row-inprogress');\n        const fallbackQueued = !status && row.classList.contains('js-row-queued');\n        if (isProcessing || isQueued || fallbackProcessing || fallbackQueued) {\n            ids.push(pid);\n        }\n    });\n    return ids;\n}\n\n/**\n * Apply returned progress values to DOM.\n * @param {Array} entries\n */\nfunction applyProgress(entries) {\n    const now = Date.now();\n    entries.forEach(entry => {\n        const row = document.querySelector('tr[data-pendingid=\"' + entry.id + '\"]');\n        if (!row) {\n            return;\n        }\n        // Initialize smoothing when processing begins and it's not tracked.\n        if (entry.status === 'processing') {\n            if (!startTimes.has(entry.id)) {\n                startTimes.set(entry.id, now);\n                // Randomize expected duration 20-55s.\n                const expected = 20000 + Math.floor(Math.random() * 35001);\n                expectedDurations.set(entry.id, expected);\n                // Randomize starting offset 1-8% to avoid uniform starts.\n                startOffsets.set(entry.id, 1 + Math.floor(Math.random() * 8));\n                // Randomize easing curve factor for diversity (ease-out exponent).\n                curveFactors.set(entry.id, 0.6 + Math.random() * 0.8); // 0.6..1.4\n                // Initialize last shown.\n                lastShown.set(entry.id, 0);\n            }\n        }\n\n        // Compute adjusted client-side progress.\n        let adjusted = 0;\n        if (entry.status === 'processing' && startTimes.has(entry.id)) {\n            const startedAt = startTimes.get(entry.id);\n            const expected = expectedDurations.get(entry.id) || 35000;\n            const elapsed = Math.max(0, now - startedAt);\n            const t = Math.min(0.999, Math.max(0, elapsed / expected));\n            const start = startOffsets.get(entry.id) || 1;\n            const curve = curveFactors.get(entry.id) || 1.0;\n            // Ease-out with variable exponent to diversify curves.\n            const eased = 1 - Math.pow(1 - t, curve);\n            let estimated = start + Math.floor(eased * (99 - start));\n            // Add small, bounded per-tick noise to avoid perfectly smooth growth.\n            const noise = Math.floor((Math.random() * 5) - 2); // -2..+2\n            estimated = Math.max(start, Math.min(99, estimated + noise));\n            // Ensure monotonic increase.\n            const last = lastShown.get(entry.id) || 0;\n            adjusted = Math.max(last, estimated);\n            lastShown.set(entry.id, adjusted);\n        }\n\n        // If status is no longer processing, clear smoothing state.\n        if (entry.status !== 'processing') {\n            startTimes.delete(entry.id);\n            expectedDurations.delete(entry.id);\n            startOffsets.delete(entry.id);\n            curveFactors.delete(entry.id);\n            lastShown.delete(entry.id);\n        }\n\n        row.setAttribute('data-status', entry.status);\n        if (entry.status === 'queued') {\n            row.classList.add('js-row-queued');\n        } else {\n            row.classList.remove('js-row-queued');\n        }\n        row.setAttribute('data-progress', String(adjusted));\n        updateRow(row, adjusted, entry.status, entry.grade);\n    });\n\n    reflectHeaderButtonsState();\n}\n\nfunction stopPolling() {\n    if (intervalid) {\n        clearInterval(intervalid);\n        intervalid = 0;\n    }\n}\n\n/**\n * Poll backend for progress.\n * @returns {boolean}\n */\nfunction poll() {\n    const ids = collectPendingIds();\n    if (ids.length === 0) {\n        stopPolling();\n        reflectHeaderButtonsState();\n        return false;\n    }\n\n    Ajax.call([{\n        methodname: 'local_assign_ai_get_progress',\n        args: { pendingids: ids },\n    }])[0].done(result => {\n        applyProgress(result);\n    }).fail(err => {\n        Notification.exception(err);\n    });\n\n    return true;\n}\n\nfunction startPolling() {\n    if (intervalid) {\n        return;\n    }\n    if (!poll()) {\n        return;\n    }\n    intervalid = setInterval(poll, POLL_MS_DEFAULT);\n}\n\n/**\n * Init module.\n * @param {number} cmid\n */\nexport function init(cmid) {\n    // Initial reflect and start polling.\n    reflectHeaderButtonsState();\n    const initialDelay = document.body.classList.contains('assign-ai-progress-running') ? 0 : POLL_MS_DEFAULT;\n\n    document.addEventListener('click', (e) => {\n        const target = e.target.closest('a.js-btn-grade');\n        if (target && (target.classList.contains('disabled') || target.getAttribute('aria-disabled') === 'true')) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }, true);\n\n    if (hasActiveRows()) {\n        setTimeout(() => {\n            startPolling();\n        }, initialDelay);\n    }\n}\n\n/**\n * Public helper so other modules (e.g. review_with_ai) can force the poller to start.\n */\nexport function ensurePolling() {\n    startPolling();\n}\n"],"names":["startPolling","cmid","reflectHeaderButtonsState","initialDelay","document","body","classList","contains","addEventListener","e","target","closest","getAttribute","preventDefault","stopPropagation","hasActiveRows","setTimeout","intervalid","startTimes","Map","expectedDurations","startOffsets","curveFactors","lastShown","setLinkDisabled","link","disabled","add","setAttribute","remove","removeAttribute","querySelector","anyActive","anyPending","btnReviewAll","btnApproveAll","updateRow","row","progress","status","grade","badge","hint","indicator","btnReview","btnDetails","btnGrade","createElement","className","innerHTML","appendChild","then","txt","catch","querySelectorAll","forEach","b","t","textContent","gradeCell","rounded","Math","round","String","applyGradeToRow","poll","ids","rows","pid","parseInt","toLowerCase","isProcessing","isQueued","fallbackProcessing","fallbackQueued","push","collectPendingIds","length","clearInterval","call","methodname","args","pendingids","done","result","entries","now","Date","entry","id","has","set","expected","floor","random","adjusted","startedAt","get","elapsed","max","min","start","curve","eased","pow","estimated","noise","last","delete","applyProgress","fail","err","exception","setInterval"],"mappings":"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"}