{"version":3,"file":"inject_simple_grade.min.js","sources":["../../src/inject_ai/inject_simple_grade.js"],"sourcesContent":["// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * Injects a simple numeric grade.\n *\n * @module      local_assign_ai/inject_ai/inject_simple_grade\n * @copyright   2025 Datacurso\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Injects simple numeric grade.\n *\n * @param {number|string} grade The grade to inject.\n * @param {{root?: Element|Document}} options Injection options.\n * @returns {boolean} True if grade was injected successfully\n */\nexport const injectSimpleGrade = (grade, options = {}) => {\n    if (grade === null || grade === undefined) {\n        return false;\n    }\n\n    const root = options.root || document;\n    const targetUserid = options.targetUserid ? parseInt(options.targetUserid, 10) : 0;\n    const candidates = Array.from(root.querySelectorAll('#id_grade, input[name=\"grade\"]'));\n    const filtered = candidates.filter((el) => {\n        if (!targetUserid) {\n            return true;\n        }\n        const form = el.closest('form');\n        if (!form) {\n            return true;\n        }\n        const userinput = form.querySelector('input[name=\"userid\"]');\n        if (!userinput) {\n            return true;\n        }\n        return parseInt(userinput.value, 10) === targetUserid;\n    });\n    const input = filtered.find(el => el && (el.offsetParent !== null || el.getClientRects().length > 0))\n        || filtered[0]\n        || candidates[0];\n    if (!input) {\n        return false;\n    }\n\n    if (input.value != grade) {\n        input.value = grade;\n        input.dispatchEvent(new Event('change', { bubbles: true }));\n    }\n\n    return true;\n};\n"],"names":["grade","options","root","document","targetUserid","parseInt","candidates","Array","from","querySelectorAll","filtered","filter","el","form","closest","userinput","querySelector","value","input","find","offsetParent","getClientRects","length","dispatchEvent","Event","bubbles"],"mappings":"4MA8BiC,SAACA,WAAOC,+DAAU,MAC3CD,MAAAA,aACO,QAGLE,KAAOD,QAAQC,MAAQC,SACvBC,aAAeH,QAAQG,aAAeC,SAASJ,QAAQG,aAAc,IAAM,EAC3EE,WAAaC,MAAMC,KAAKN,KAAKO,iBAAiB,mCAC9CC,SAAWJ,WAAWK,QAAQC,SAC3BR,oBACM,QAELS,KAAOD,GAAGE,QAAQ,YACnBD,YACM,QAELE,UAAYF,KAAKG,cAAc,+BAChCD,WAGEV,SAASU,UAAUE,MAAO,MAAQb,gBAEvCc,MAAQR,SAASS,MAAKP,IAAMA,KAA2B,OAApBA,GAAGQ,cAAyBR,GAAGS,iBAAiBC,OAAS,MAC3FZ,SAAS,IACTJ,WAAW,WACbY,QAIDA,MAAMD,OAASjB,QACfkB,MAAMD,MAAQjB,MACdkB,MAAMK,cAAc,IAAIC,MAAM,SAAU,CAAEC,SAAS,OAGhD"}