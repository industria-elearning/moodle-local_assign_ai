define("local_assign_ai/inject_ai/inject_guide",["exports","./normalize_string"],(function(_exports,_normalize_string){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.injectGuide=void 0;_exports.injectGuide=function(guideData){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const root=options.root||document,targetUserid=options.targetUserid?parseInt(options.targetUserid,10):0;let injected=!1;return Object.keys(guideData).forEach((criterionName=>{const data=guideData[criterionName];if(!data)return;const grade=data.grade;let comments=data.reply;Array.isArray(comments)&&(comments=comments.join(", "));const allrows=Array.from(root.querySelectorAll("tr")).filter((row=>{if(!targetUserid)return!0;const form=row.closest("form");if(!form)return!0;const userinput=form.querySelector('input[name="userid"]');return!userinput||parseInt(userinput.value,10)===targetUserid})),visiblerows=allrows.filter((row=>null!==row.offsetParent||row.getClientRects().length>0));(visiblerows.length?visiblerows:allrows).forEach((row=>{if(!(0,_normalize_string.normalizeString)(row.textContent).includes((0,_normalize_string.normalizeString)(criterionName)))return;const scoreInput=row.querySelector('.score input[type="text"]'),remarkTextarea=row.querySelector(".remark textarea");let rowUpdated=!1;scoreInput&&null!=grade&&(scoreInput.value!=grade&&(scoreInput.value=grade,scoreInput.dispatchEvent(new Event("change",{bubbles:!0}))),rowUpdated=!0),remarkTextarea&&comments&&(remarkTextarea.value!==comments&&(remarkTextarea.value=comments,remarkTextarea.dispatchEvent(new Event("input",{bubbles:!0})),remarkTextarea.dispatchEvent(new Event("change",{bubbles:!0}))),rowUpdated=!0),rowUpdated&&(injected=!0)}))})),injected}}));

//# sourceMappingURL=inject_guide.min.js.map